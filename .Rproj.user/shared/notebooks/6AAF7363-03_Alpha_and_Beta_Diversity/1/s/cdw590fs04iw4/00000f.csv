"0","# Convert the phyloseq object to a metagenomeSeq object"
"0","metagenome.obj_s<-phyloseq_to_metagenomeSeq(ps1_s)"
"0","metagenome.obj_g<-phyloseq_to_metagenomeSeq(ps1_g)"
"0",""
"0","# Calculate the percentile by which to normalize counts"
"0","p_s<-metagenomeSeq::cumNormStatFast(metagenome.obj_s) #0.5"
"0","p_g<-metagenomeSeq::cumNormStatFast(metagenome.obj_g) #0.5"
"0",""
"0","# Normalize counts"
"0","metagenome.obj_s<-metagenomeSeq::cumNorm(metagenome.obj_s, p = p_s)"
"0","metagenome.obj_g<-metagenomeSeq::cumNorm(metagenome.obj_g, p = p_g)"
"0",""
"0","# Normalized count table to data-frame ASV table - log transformed data"
"0","metag.norm.counts_s<-metagenomeSeq::MRcounts(metagenome.obj_s, norm = TRUE, log = TRUE)"
"0","metag.norm.counts_g<-metagenomeSeq::MRcounts(metagenome.obj_g, norm = TRUE, log = TRUE )"
"0",""
"0","# Make a new phyloseq object (combine normalized ASV table with filtered taxa)"
"0","asv_s_css.obj<-otu_table(metag.norm.counts_s, taxa_are_rows = TRUE)"
"0","ps_css_s.obj<-phyloseq(asv_s_css.obj,taxa_s.obj, meta_s.obj) "
"0",""
"0","asv_g_css.obj<-otu_table(metag.norm.counts_g, taxa_are_rows = TRUE)"
"0","ps_css_g.obj<-phyloseq(asv_g_css.obj,taxa_g.obj, meta_g.obj) "
"0","ps_css.obj<-merge_phyloseq(ps_css_s.obj,ps_css_g.obj)"
