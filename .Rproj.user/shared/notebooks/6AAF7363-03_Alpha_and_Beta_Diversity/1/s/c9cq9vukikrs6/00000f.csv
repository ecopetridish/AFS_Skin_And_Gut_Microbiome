"0","# Plot beta diversity"
"0","## perform nmds"
"0","nmds_s<-metaMDS(bray_curtis_dist_s, k = 2,trymax = 100)"
"1","Run 0 stress"
"1"," "
"1","0.1187011"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","1"
"1"," "
"1","stress"
"1"," "
"1","0.1337989"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","2"
"1"," "
"1","stress"
"1"," "
"1","0.1661526"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","3"
"1"," "
"1","stress"
"1"," "
"1","0.1187129"
"1"," "
"1","
"
"1","... Procrustes: rmse"
"1"," "
"1","0.002514479"
"1"," "
"1"," max resid"
"1"," "
"1","0.01182293"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","4"
"1"," "
"1","stress"
"1"," "
"1","0.1232861"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","5"
"1"," "
"1","stress"
"1"," "
"1","0.1187011"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","9.430429e-05"
"1"," "
"1"," max resid"
"1"," "
"1","0.0005028097"
"1"," "
"1","
"
"1","... Similar to previous best
"
"1","Run"
"1"," "
"1","6"
"1"," "
"1","stress"
"1"," "
"1","0.1357433"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","7"
"1"," "
"1","stress"
"1"," "
"1","0.1187128"
"1"," "
"1","
"
"1","... Procrustes: rmse"
"1"," "
"1","0.002502647"
"1"," "
"1"," max resid"
"1"," "
"1","0.01183743"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","8"
"1"," "
"1","stress"
"1"," "
"1","0.1380686"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","9"
"1"," "
"1","stress"
"1"," "
"1","0.1449291"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","10"
"1"," "
"1","stress"
"1"," "
"1","0.1338265"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","11"
"1"," "
"1","stress"
"1"," "
"1","0.1356178"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","12"
"1"," "
"1","stress"
"1"," "
"1","0.1187011"
"1"," "
"1","
"
"1","... Procrustes: rmse"
"1"," "
"1","1.90501e-05"
"1"," "
"1"," max resid"
"1"," "
"1","9.5928e-05"
"1"," "
"1","
"
"1","... Similar to previous best
"
"1","Run"
"1"," "
"1","13"
"1"," "
"1","stress"
"1"," "
"1","0.1631938"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","14"
"1"," "
"1","stress"
"1"," "
"1","0.1232861"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","15"
"1"," "
"1","stress"
"1"," "
"1","0.1578221"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","16"
"1"," "
"1","stress"
"1"," "
"1","0.1187011"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","1.398105e-05"
"1"," "
"1"," max resid"
"1"," "
"1","7.154031e-05"
"1"," "
"1","
"
"1","... Similar to previous best
"
"1","Run"
"1"," "
"1","17"
"1"," "
"1","stress"
"1"," "
"1","0.1787435"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","18"
"1"," "
"1","stress"
"1"," "
"1","0.185979"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","19"
"1"," "
"1","stress"
"1"," "
"1","0.1187128"
"1"," "
"1","
"
"1","... Procrustes: rmse"
"1"," "
"1","0.002504978"
"1"," "
"1"," max resid"
"1"," "
"1","0.01183159"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","20"
"1"," "
"1","stress"
"1"," "
"1","0.1187011"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","4.725151e-06"
"1"," "
"1"," max resid"
"1"," "
"1","2.113764e-05"
"1"," "
"1","
"
"1","... Similar to previous best
"
"1","*** Best solution repeated"
"1"," "
"1","1"
"1"," "
"1","times
"
"0","nmds_g<-metaMDS(bray_curtis_dist_g, k = 2,trymax = 100) "
"1","Run 0 stress"
"1"," "
"1","0.1958661"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","1"
"1"," "
"1","stress"
"1"," "
"1","0.231209"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","2"
"1"," "
"1","stress"
"1"," "
"1","0.206287"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","3"
"1"," "
"1","stress"
"1"," "
"1","0.2063743"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","4"
"1"," "
"1","stress"
"1"," "
"1","0.2213655"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","5"
"1"," "
"1","stress"
"1"," "
"1","0.1898081"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.1231402"
"1"," "
"1"," max resid"
"1"," "
"1","0.2450429"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","6"
"1"," "
"1","stress"
"1"," "
"1","0.1898079"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.0005051076"
"1"," "
"1"," max resid"
"1"," "
"1","0.00236151"
"1"," "
"1","
"
"1","... Similar to previous best
"
"1","Run"
"1"," "
"1","7"
"1"," "
"1","stress"
"1"," "
"1","0.2309379"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","8"
"1"," "
"1","stress"
"1"," "
"1","0.2048724"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","9"
"1"," "
"1","stress"
"1"," "
"1","0.2062874"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","10"
"1"," "
"1","stress"
"1"," "
"1","0.2062894"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","11"
"1"," "
"1","stress"
"1"," "
"1","0.1898078"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","0.000235723"
"1"," "
"1"," max resid"
"1"," "
"1","0.001100888"
"1"," "
"1","
"
"1","... Similar to previous best
"
"1","Run"
"1"," "
"1","12"
"1"," "
"1","stress"
"1"," "
"1","0.220844"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","13"
"1"," "
"1","stress"
"1"," "
"1","0.2312614"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","14"
"1"," "
"1","stress"
"1"," "
"1","0.2352627"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","15"
"1"," "
"1","stress"
"1"," "
"1","0.1898078"
"1"," "
"1","
"
"1","... New best solution
"
"1","... Procrustes: rmse"
"1"," "
"1","5.032992e-05"
"1"," "
"1"," max resid"
"1"," "
"1","0.0002377045"
"1"," "
"1","
"
"1","... Similar to previous best
"
"1","Run"
"1"," "
"1","16"
"1"," "
"1","stress"
"1"," "
"1","0.1958662"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","17"
"1"," "
"1","stress"
"1"," "
"1","0.2207844"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","18"
"1"," "
"1","stress"
"1"," "
"1","0.1954256"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","19"
"1"," "
"1","stress"
"1"," "
"1","0.1965367"
"1"," "
"1","
"
"1","Run"
"1"," "
"1","20"
"1"," "
"1","stress"
"1"," "
"1","0.1958661"
"1"," "
"1","
"
"1","*** Best solution repeated"
"1"," "
"1","1"
"1"," "
"1","times
"
"0","## extract nmds scores"
"0","nmds_scores_s<-as.data.frame(scores(nmds_s))"
"0","nmds_scores_s$Sample_ID<- rownames(nmds_scores_s)"
"0","nmds_scores_s<-merge(nmds_scores_s, as.data.frame(meta_s), by = ""Sample_ID"")"
"0","nmds_scores_s<-nmds_scores_s %>% mutate(Age = recode_factor(Age, ""Mum"" = ""Mother"")) %>% mutate(Colony_Age=paste0(Colony,""_"",Age))"
"0",""
"0","nmds_scores_g<-as.data.frame(scores(nmds_g))"
"0","nmds_scores_g$Sample_ID<- rownames(nmds_scores_g)"
"0","nmds_scores_g<-merge(nmds_scores_g, as.data.frame(meta_g), by = ""Sample_ID"")"
"0","nmds_scores_g<-nmds_scores_g %>% mutate(Age = recode_factor(Age, ""Mum"" = ""Mother"")) %>% "
"0","               mutate(Colony_Age=paste0(Colony,""_"",Age))"
"0",""
"0",""
"0","## beta diversity plots"
"0","b1<-ggplot(nmds_scores_s, aes(x = NMDS1, y = NMDS2, color = factor(Colony_Age), "
"0","             group = Pair_ID)) + "
"0","    geom_line() +"
"0","    geom_point(size = 1.6) + "
"0","    theme_classic() + "
"0","    scale_color_manual(values = c(""#01665E"", ""#80CDC1"", ""#C51B7D"", ""#E9A3C9"")) +"
"0","    labs(x = ""NMDS1"", y = ""NMDS2"", color = ""Col_Age"") +"
"0","    theme(axis.line = element_line(size = 0.6, linetype = 1, colour = ""black""),"
"0","          axis.title.y = element_text(vjust = 0.3), # because y title was far away from margin"
"0","          axis.ticks = element_line(size = 0.5, linetype = 1, colour = ""black""),"
"0","          axis.title = element_text(size = 18),"
"0","          axis.text = element_text(size = 16, colour = ""black""),"
"0","          plot.title = element_text(hjust = 0.05, vjust = -1, size = 18),"
"0","          legend.position = ""none"") +"
"0","    scale_y_continuous(limits = c(-0.7, 0.8), breaks = seq(-0.6,0.6,0.3))"
"0",""
"0","b2<-ggplot(nmds_scores_g, aes(x = NMDS1, y = NMDS2, color = factor(Colony_Age),"
"0","                                group = Pair_ID)) + "
"0","    geom_line() +"
"0","    geom_point(size = 1.6) + "
"0","    guides(color = guide_legend(ncol = 2)) + "
"0","    theme_classic() + "
"0","    scale_color_manual(values = c(""#01665E"", ""#80CDC1"", ""#C51B7D"", ""#E9A3C9"")) +"
"0","    scale_y_continuous(labels = number_format(accuracy = 0.1), limits = c(-0.8,0.5), breaks = seq(-0.8,0.5, by = 0.4)) +  # Format y-axis labels to 1 decimal place"
"0","    labs(x = ""NMDS1"", y = ""NMDS2"", color = ""Col_Age"") +"
"0","    theme(axis.line = element_line(size = 0.6, linetype = 1, colour = ""black""),"
"0","          axis.title.y = element_text(vjust = 0.3), # because y title was far away from margin"
"0","          axis.ticks = element_line(size = 0.5, linetype = 1, colour = ""black""),"
"0","          axis.title = element_text(size = 18),"
"0","          axis.text = element_text(size = 16, colour = ""black""),"
"0","          plot.title = element_text(hjust = 0.05, vjust = -1, size = 18),"
"0","          legend.position = ""bottom"","
"0","          legend.text = element_text(size = 16),"
"0","          legend.title = element_blank())"
